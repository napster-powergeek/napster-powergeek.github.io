<div>
    <h1><center style="background-color:#87CEFA; color:white;"> Bitcoin
        Historical Data Analysis</center></h1>
</div>


<div>
<img src="https://thumbs.gfycat.com/IllSharpCod-max-1mb.gif" width='350'>
</div>

<a id="top"></a>

<div class="list-group" id="list-tab" role="tablist">
<h3 class="list-group-item list-group-item-action active" data-toggle="list" style='background-color:#87CEFA; border:0' role="tab" aria-controls="home" color=black><center>Quick navigation</center></h3>

* [1. Required Libraries](#1)
* [2. Dataset Quick Overview & Pre-Processing](#2)
* [3. Features generation](#3)
* [4. Distribution of Features](#4)
* [5. Correlation Analysis ](#5)   
* [6. Candle stick chart on Bitcoin historical data](#6)
* [7. Time series analysis and prediction using prophet](#7)
* [8. Regression analysis using pycaret](#8)
* [9. References](#9)



<div class="alert alert-info">
<h3><center>Bitcoin[a] (â‚¿) is a cryptocurrency invented in 2008 by an unknown person or group of people using the name Satoshi Nakamoto.<center><h3>
<h4>Some interesting facts about Bitcoin(BTC):</h4>
<h5>1.Bitcoin is a decentralized digital currency, without a central bank or single administrator, that can be sent from user to user on the peer-to-peer bitcoin network without the need for intermediaries. Transactions are verified by network nodes through cryptography and recorded in a public distributed ledger called a blockchain.</h5>
<h5>2. In fact, there are only 21 million bitcoins that can be mined in total.Once miners have unlocked this amount of bitcoins, the supply will be exhausted.</h5>
<h5>3. Currently, around 18.5 million bitcoin have been mined. This leaves less than three million that have yet to be introduced into circulation.</h5>
</div>

<a id="1"></a>
<h2 style='background-color:#87CEFA; border:0; color:black'><center>Required Libraries</center><h2>


```python

#Data Pre-Processing packages:
import numpy as np 
import pandas as pd 
from datetime import datetime


#Data Visualization Packages:
#Seaborn
import seaborn as sns
sns.set(rc={'figure.figsize':(10,6)})
custom_colors = ["#4e89ae", "#c56183","#ed6663","#ffa372"]

#Matplotlib
import matplotlib.pyplot as plt
%matplotlib inline
import matplotlib.image as mpimg

#Colorama
from colorama import Fore, Back, Style # For text colors
y_= Fore.CYAN
m_= Fore.WHITE

#garbage collector - To free up unused space
import gc
gc.collect()

#NetworkX
import networkx as nx
import plotly.graph_objects as go #To construct network graphs

#To avoid printing of un necessary Deprecation warning and future warnings!
import warnings
warnings.filterwarnings("ignore", category=DeprecationWarning)
warnings.filterwarnings("ignore", category=FutureWarning)

#Time series Analysis pacakages:

from statsmodels.tsa.seasonal import seasonal_decompose
from statsmodels.tsa.stattools import kpss
from statsmodels.tsa.stattools import adfuller
from statsmodels.graphics.tsaplots import plot_acf, plot_pacf

#Facebook Prophet packages:
from fbprophet import Prophet
from fbprophet.diagnostics import cross_validation, performance_metrics
from fbprophet.plot import add_changepoints_to_plot, plot_cross_validation_metric

#Time -To find how long each cell takes to run
import time

#Importing of Data 
data=pd.read_csv('../input/bitcoin-historical-data/bitstampUSD_1-min_data_2012-01-01_to_2020-12-31.csv')


```

<a id="2"></a>
<h2 style='background-color:#87CEFA; border:0; color:black'><center>Data set Overview & Pre-Processing</center><h2>


```python
print(f"{m_}Total records:{y_}{data.shape}\n")
print(f"{m_}Data types of data columns: \n{y_}{data.dtypes}")
```

    [37mTotal records:[36m(4727777, 8)
    
    [37mData types of data columns: 
    [36mTimestamp              int64
    Open                 float64
    High                 float64
    Low                  float64
    Close                float64
    Volume_(BTC)         float64
    Volume_(Currency)    float64
    Weighted_Price       float64
    dtype: object
    

<div class="alert alert-info">
    <h3 color:black><center><b> Data Pre-processing steps</b></center></h3>
    <p> 1. <b>Date</b> - We need to convert the Hourly data to Daily based data </p>
    <p> 2. <b>Fill in the missing values interpolation</p>

</div>

<div class='alert alert-info'>
<h3> The data is available on a Hourly based on each day, So we need to resample them to day based.</h3>
</div>


```python
data['Timestamp'] = [datetime.fromtimestamp(x) for x in data['Timestamp']]
data = data.set_index('Timestamp')
data = data.resample("24H").mean()
data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume_(BTC)</th>
      <th>Volume_(Currency)</th>
      <th>Weighted_Price</th>
    </tr>
    <tr>
      <th>Timestamp</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2011-12-31</th>
      <td>4.465000</td>
      <td>4.482500</td>
      <td>4.465000</td>
      <td>4.482500</td>
      <td>23.829470</td>
      <td>106.330084</td>
      <td>4.471603</td>
    </tr>
    <tr>
      <th>2012-01-01</th>
      <td>4.806667</td>
      <td>4.806667</td>
      <td>4.806667</td>
      <td>4.806667</td>
      <td>7.200667</td>
      <td>35.259720</td>
      <td>4.806667</td>
    </tr>
    <tr>
      <th>2012-01-02</th>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>19.048000</td>
      <td>95.240000</td>
      <td>5.000000</td>
    </tr>
    <tr>
      <th>2012-01-03</th>
      <td>5.252500</td>
      <td>5.252500</td>
      <td>5.252500</td>
      <td>5.252500</td>
      <td>11.004660</td>
      <td>58.100651</td>
      <td>5.252500</td>
    </tr>
    <tr>
      <th>2012-01-04</th>
      <td>5.200000</td>
      <td>5.223333</td>
      <td>5.200000</td>
      <td>5.223333</td>
      <td>11.914807</td>
      <td>63.119577</td>
      <td>5.208159</td>
    </tr>
  </tbody>
</table>
</div>



<div class="alert alert-info">
    <h3><b><center>Missing values</center><b></h3>
</div>



```python
missed = pd.DataFrame()
missed['column'] = data.columns

missed['percent'] = [round(100* data[col].isnull().sum() / len(data), 2) for col in data.columns]
missed = missed.sort_values('percent',ascending=False)
missed = missed[missed['percent']>0]

fig = sns.barplot(
    x=missed['percent'], 
    y=missed["column"], 
    orientation='horizontal',palette="winter"
).set_title('Missed values percent for every column')
```


    
![png](/assets/images/bitcoin/output_12_0.png)
    


<div class="alert alert-info">
    <h3><b><center>Let's interpolate to fill in the missing values</center><b></h3>
</div>



```python
def fill_missing(df):
    ### function to impute missing values using interpolation ###
    df['Open'] = df['Open'].interpolate()
    df['Close'] = df['Close'].interpolate()
    df['Weighted_Price'] = df['Weighted_Price'].interpolate()
    df['Volume_(BTC)'] = df['Volume_(BTC)'].interpolate()
    df['Volume_(Currency)'] = df['Volume_(Currency)'].interpolate()
    df['High'] = df['High'].interpolate()
    df['Low'] = df['Low'].interpolate()
    print(f'{m_}No. of Missing values after interpolation:\n{y_}{df.isnull().sum()}')
    
fill_missing(data)
```

    [37mNo. of Missing values after interpolation:
    [36mOpen                 0
    High                 0
    Low                  0
    Close                0
    Volume_(BTC)         0
    Volume_(Currency)    0
    Weighted_Price       0
    dtype: int64
    

<a id="3"></a>
<h2 style='background-color:#87CEFA; border:0; color:black'><center>Feature Generation</center><h2>


```python
data.columns
```




    Index(['Open', 'High', 'Low', 'Close', 'Volume_(BTC)', 'Volume_(Currency)',
           'Weighted_Price'],
          dtype='object')




```python
new_df=data.groupby('Timestamp').mean()
new_df=new_df[['Volume_(BTC)', 'Close','Volume_(Currency)']]
new_df.rename(columns={'Volume_(BTC)':'Volume_market_mean','Close':'close_mean','Volume_(Currency)':'volume_curr_mean'},inplace=True)
new_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Volume_market_mean</th>
      <th>close_mean</th>
      <th>volume_curr_mean</th>
    </tr>
    <tr>
      <th>Timestamp</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2011-12-31</th>
      <td>23.829470</td>
      <td>4.482500</td>
      <td>106.330084</td>
    </tr>
    <tr>
      <th>2012-01-01</th>
      <td>7.200667</td>
      <td>4.806667</td>
      <td>35.259720</td>
    </tr>
    <tr>
      <th>2012-01-02</th>
      <td>19.048000</td>
      <td>5.000000</td>
      <td>95.240000</td>
    </tr>
    <tr>
      <th>2012-01-03</th>
      <td>11.004660</td>
      <td>5.252500</td>
      <td>58.100651</td>
    </tr>
    <tr>
      <th>2012-01-04</th>
      <td>11.914807</td>
      <td>5.223333</td>
      <td>63.119577</td>
    </tr>
  </tbody>
</table>
</div>




```python
data_df = data.merge(new_df, left_on='Timestamp',
                                right_index=True)
data_df['volume(BTC)/Volume_market_mean'] = data_df['Volume_(BTC)'] / data_df['Volume_market_mean']
data_df['Volume_(Currency)/volume_curr_mean'] = data_df['Volume_(Currency)'] / data_df['volume_curr_mean']

data_df['close/close_market_mean'] = data_df['Close'] / data_df['close_mean']
data_df['open/close'] = data_df['Open'] / data_df['Close']
data_df["gap"] = data_df["High"] - data_df["Low"] 
data_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume_(BTC)</th>
      <th>Volume_(Currency)</th>
      <th>Weighted_Price</th>
      <th>Volume_market_mean</th>
      <th>close_mean</th>
      <th>volume_curr_mean</th>
      <th>volume(BTC)/Volume_market_mean</th>
      <th>Volume_(Currency)/volume_curr_mean</th>
      <th>close/close_market_mean</th>
      <th>open/close</th>
      <th>gap</th>
    </tr>
    <tr>
      <th>Timestamp</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2011-12-31</th>
      <td>4.465000</td>
      <td>4.482500</td>
      <td>4.465000</td>
      <td>4.482500</td>
      <td>23.829470</td>
      <td>106.330084</td>
      <td>4.471603</td>
      <td>23.829470</td>
      <td>4.482500</td>
      <td>106.330084</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.996096</td>
      <td>0.017500</td>
    </tr>
    <tr>
      <th>2012-01-01</th>
      <td>4.806667</td>
      <td>4.806667</td>
      <td>4.806667</td>
      <td>4.806667</td>
      <td>7.200667</td>
      <td>35.259720</td>
      <td>4.806667</td>
      <td>7.200667</td>
      <td>4.806667</td>
      <td>35.259720</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2012-01-02</th>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>19.048000</td>
      <td>95.240000</td>
      <td>5.000000</td>
      <td>19.048000</td>
      <td>5.000000</td>
      <td>95.240000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2012-01-03</th>
      <td>5.252500</td>
      <td>5.252500</td>
      <td>5.252500</td>
      <td>5.252500</td>
      <td>11.004660</td>
      <td>58.100651</td>
      <td>5.252500</td>
      <td>11.004660</td>
      <td>5.252500</td>
      <td>58.100651</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2012-01-04</th>
      <td>5.200000</td>
      <td>5.223333</td>
      <td>5.200000</td>
      <td>5.223333</td>
      <td>11.914807</td>
      <td>63.119577</td>
      <td>5.208159</td>
      <td>11.914807</td>
      <td>5.223333</td>
      <td>63.119577</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.995533</td>
      <td>0.023333</td>
    </tr>
  </tbody>
</table>
</div>



<div class='alert alert-info'>
     <p> Sometimes, the data set might be too huge to process, since we are using dataframe. To make sure we dont hold up too much RAM. We could try other approaches like</p>
     <p> 1. use gc.collect() - collects all the garbage values </p>
     <p> 2. del dataframe - free up some space by deleting the unused dataframe using the del command </p>
     <p> 3. Reduce the memory usage based on the data types of the columns in the dataframe(shown below)</p>
</div>


```python
def mem_usage(pandas_obj):
    if isinstance(pandas_obj,pd.DataFrame):
        usage_b = pandas_obj.memory_usage(deep=True).sum()
    else: # we assume if not a df it's a series
        usage_b = pandas_obj.memory_usage(deep=True)
    usage_mb = usage_b / 1024 ** 2 # convert bytes to megabytes
    return "{:03.2f} MB".format(usage_mb)
print(f'{m_}Memory of the dataframe:\n{y_}{mem_usage(data_df)}')
```

    [37mMemory of the dataframe:
    [36m0.40 MB
    


```python
#All the columns in float64 format, we can downsize them to float32 to reduce memory usage 
data_df.info()

```

    <class 'pandas.core.frame.DataFrame'>
    DatetimeIndex: 3289 entries, 2011-12-31 to 2020-12-31
    Data columns (total 15 columns):
     #   Column                              Non-Null Count  Dtype  
    ---  ------                              --------------  -----  
     0   Open                                3289 non-null   float64
     1   High                                3289 non-null   float64
     2   Low                                 3289 non-null   float64
     3   Close                               3289 non-null   float64
     4   Volume_(BTC)                        3289 non-null   float64
     5   Volume_(Currency)                   3289 non-null   float64
     6   Weighted_Price                      3289 non-null   float64
     7   Volume_market_mean                  3289 non-null   float64
     8   close_mean                          3289 non-null   float64
     9   volume_curr_mean                    3289 non-null   float64
     10  volume(BTC)/Volume_market_mean      3289 non-null   float64
     11  Volume_(Currency)/volume_curr_mean  3289 non-null   float64
     12  close/close_market_mean             3289 non-null   float64
     13  open/close                          3289 non-null   float64
     14  gap                                 3289 non-null   float64
    dtypes: float64(15)
    memory usage: 411.1 KB
    

<div class='alert alert-info'>
<h3>We can use the function pd.to_numeric() to downcast our float types. Weâ€™ll use DataFrame.select_dtypes to select only the float columns, then weâ€™ll optimize the types and compare the memory usage.</h3>
</div>


```python
gl_float = data_df.select_dtypes(include=['float'])
converted_float = gl_float.apply(pd.to_numeric,downcast='float')
compare_floats = pd.concat([gl_float.dtypes,converted_float.dtypes],axis=1)
compare_floats.columns = ['Before','After']
compare_floats.apply(pd.Series.value_counts)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Before</th>
      <th>After</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>float32</th>
      <td>NaN</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>float64</th>
      <td>15.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
print(f"{m_}Before float conversion:\n{y_}{mem_usage(data_df)}")
data_df[converted_float.columns] = converted_float
print(f"{m_}After float conversion:\n{y_}{mem_usage(data_df)}")
```

    [37mBefore float conversion:
    [36m0.40 MB
    [37mAfter float conversion:
    [36m0.21 MB
    

<div class='alert alert-info'>
    <h3>We have successfully reduced the size of the dataframe by 50%. Eventhough, the size of the dataframe used here is small in this analysis. It's always a good aprroach to reduce the memory usage</h3>
</div>

<a id="4"></a>
<h2 style='background-color:#87CEFA; border:0; color:black'><center>Distribution of Features</center><h2>

<div class="alert alert-info">
    <h3><b>Let's Visualize the distribution of the key variables like Opening price, Highest price, Lowest price and Volume in Bitcoin<b></h3>
</div>



```python
def triple_plot(x, title,c):
    fig, ax = plt.subplots(3,1,figsize=(25,10),sharex=True)
    sns.distplot(x, ax=ax[0],color=c)
    ax[0].set(xlabel=None)
    ax[0].set_title('Histogram + KDE')
    sns.boxplot(x, ax=ax[1],color=c)
    ax[1].set(xlabel=None)
    ax[1].set_title('Boxplot')
    sns.violinplot(x, ax=ax[2],color=c)
    ax[2].set(xlabel=None)
    ax[2].set_title('Violin plot')
    fig.suptitle(title, fontsize=30)
    plt.tight_layout(pad=3.0)
    plt.show()
```


```python
triple_plot(data['Open'],'Distribution of Opening price',custom_colors[0])
```


    
![png](/assets/images/bitcoin/output_29_0.png)
    



```python
triple_plot(data['High'],'Distribution of the highest price',custom_colors[1])
```


    
![png](/assets/images/bitcoin/output_30_0.png)
    



```python
triple_plot(data['Low'],'Distribution of Lowest Price',custom_colors[2])
```


    
![png](/assets/images/bitcoin/output_31_0.png)
    



```python
triple_plot(data['Close'],'Distribution of the closing Price',custom_colors[3])
```


    
![png](/assets/images/bitcoin/output_32_0.png)
    



```python
triple_plot(data['Volume_(BTC)'],'Distribution of Volume in BTC ',custom_colors[0])
```


    
![png](/assets/images/bitcoin/output_33_0.png)
    



```python
triple_plot(data['Volume_(Currency)'],'Distribution of Volume',custom_colors[1])
```


    
![png](/assets/images/bitcoin/output_34_0.png)
    



```python
triple_plot(data['Weighted_Price'],'Distribution of Weighted price',custom_colors[2])
```


    
![png](/assets/images/bitcoin/output_35_0.png)
    


<a id="5"></a>
<h2 style='background-color:#87CEFA; border:0; color:black'><center>Correlation Analysis</center><h2>


```python
plt.figure(figsize=(8,8))
corr=data_df[data_df.columns[1:]].corr()
mask = np.triu(np.ones_like(corr, dtype=bool))
sns.heatmap(data_df[data_df.columns[1:]].corr(), mask=mask, cmap='coolwarm', vmax=.3, center=0,
            square=True, linewidths=.5,annot=True)
plt.show()
```


    
![png](/assets/images/bitcoin/output_37_0.png)
    



```python
data_df=data_df.drop(columns=['volume(BTC)/Volume_market_mean','Volume_(Currency)/volume_curr_mean','close/close_market_mean'])
data_df.columns
```




    Index(['Open', 'High', 'Low', 'Close', 'Volume_(BTC)', 'Volume_(Currency)',
           'Weighted_Price', 'Volume_market_mean', 'close_mean',
           'volume_curr_mean', 'open/close', 'gap'],
          dtype='object')



<div class="alert alert-info">
    <h3><b><center>Correlation Network</center><b></h3>
</div>



```python
indices = corr.index.values
cor_matrix = np.asmatrix(corr)
G = nx.from_numpy_matrix(cor_matrix)
G = nx.relabel_nodes(G,lambda x: indices[x])
#G.edges(data=True)
```


```python
def corr_network(G, corr_direction, min_correlation):
    H = G.copy()

    for s1, s2, weight in G.edges(data=True):       
        if corr_direction == "positive":
            if weight["weight"] < 0 or weight["weight"] < min_correlation:
                H.remove_edge(s1, s2)
        else:
            if weight["weight"] >= 0 or weight["weight"] > min_correlation:
                H.remove_edge(s1, s2)
                
    edges,weights = zip(*nx.get_edge_attributes(H,'weight').items())
    weights = tuple([(1+abs(x))**2 for x in weights])
   
    d = dict(nx.degree(H))
    nodelist=d.keys()
    node_sizes=d.values()
    
    positions=nx.circular_layout(H)
    
    plt.figure(figsize=(9,9))

    nx.draw_networkx_nodes(H,positions,node_color='#d100d1',nodelist=nodelist,
                       node_size=tuple([x**2 for x in node_sizes]),alpha=0.8)

    nx.draw_networkx_labels(H, positions, font_size=13)

    if corr_direction == "positive":
        edge_colour = plt.cm.summer 
    else:
        edge_colour = plt.cm.autumn
        
    nx.draw_networkx_edges(H, positions, edgelist=edges,style='solid',
                          width=weights, edge_color = weights, edge_cmap = edge_colour,
                          edge_vmin = min(weights), edge_vmax=max(weights))
    plt.axis('off')
    plt.show() 
```


```python
corr_network(G, corr_direction="positive",min_correlation = 0.5)

```


    
![png](/assets/images/bitcoin/output_42_0.png)
    


<a id="6"></a>
<h2 style='background-color:#87CEFA; border:0; color:black'><center>Candle stick chart on the price movements of the Bitcoin
    </center><h2>


<img src='https://www.tradingwithrayner.com/wp-content/uploads/2018/05/1-OHLC-COMBINE.png' width='500'>


```python
data_df.columns
```




    Index(['Open', 'High', 'Low', 'Close', 'Volume_(BTC)', 'Volume_(Currency)',
           'Weighted_Price', 'Volume_market_mean', 'close_mean',
           'volume_curr_mean', 'open/close', 'gap'],
          dtype='object')




```python
trace1 = {
    'x': data_df.index,
    'open': data_df.Open,
    'close': data_df.Close,
    'high': data_df.High,
    'low': data_df.Low,
    'type': 'candlestick',
    'name': 'MSFT',
    'showlegend': False
}
# Calculate and define moving average of 30 periods
avg_30 = data_df.Close.rolling(window=30, min_periods=1).mean()

# Calculate and define moving average of 50 periods
avg_50 = data_df.Close.rolling(window=50, min_periods=1).mean()

trace2 = {
    'x': data_df.index,
    'y': avg_30,
    'type': 'scatter',
    'mode': 'lines',
    'line': {
        'width': 1,
        'color': 'blue'
            },
    'name': 'Moving Average of 30 periods'
}

trace3 = {
    'x': data_df.index,
    'y': avg_50,
    'type': 'scatter',
    'mode': 'lines',
    'line': {
        'width': 1,
        'color': 'red'
    },
    'name': 'Moving Average of 50 periods'
}
data_trace = [trace1, trace2, trace3]
# Config graph layout
layout = go.Layout({
    'title': {
        'text': 'Bitcoin Moving Averages',
        'font': {
            'size': 15
        } 
    }
})




fig = go.Figure(data=data_trace, layout=layout)
fig.write_html("Bitcoin Moving Averages.html")
fig.show()
```


<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-latest.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>




```python
data_df.reset_index(inplace=True)
data_df['month']=data_df['Timestamp'].dt.month
layout = go.Layout({
    'title': {
        'text': 'Bitcoin Price - Monthly',
        'font': {
            'size': 15
        } 
    }
})

fig = go.Figure(data=[go.Candlestick(x=data_df['month'],
                open=data_df['Open'], high=data_df['High'],
                low=data_df['Low'], close=data_df['Weighted_Price'])
                      ],layout=layout)
fig.show()
```


<a id="7"></a>
<h2 style='background-color:#87CEFA; border:0; color:black'><center>Time series Analysis and Prediction using Prophet</center><h2>



<img src="https://insightimi.files.wordpress.com/2020/07/on-de793_201909_g_20190830121038.gif" width='500' height='500'>

<div class="alert alert-warning">
    <h1><b><center>What is Prophet?</center><b></h1>
    <h3>Prophet is a facebooksâ€™ open source time series prediction. Prophet decomposes time series into trend, seasonality and holiday. It has intuitive hyper parameters which are easy to tune.</h3>
</div>




<div class='alert alert-warning'>
    <h2><b><center>Advantages of using Prophet</center><b></h2>
        <h3> 1. Accommodates seasonality with multiple periods</h3>
        <h3> 2. Prophet is resilient to missing values</h3>
        <h3> 3. Best way to handle outliers in Prophet is to remove them</h3>
        <h3> 4. Fitting of the model is fast</h3>
    <h3> 5. Intuitive hyper parameters which are easy to tune</h3>
</div>


```python
plt.figure(figsize=(15,12))
series = data_df.Weighted_Price
result = seasonal_decompose(series, model='additive',period=1)
result.plot()
```




    
![png](/assets/images/bitcoin/output_52_0.png)
    




    <Figure size 1080x864 with 0 Axes>



    
![png](/assets/images/bitcoin/output_52_2.png)
    


<div class='alert alert-warning'>
    <h3><center>Input to Prophet is a data frame with minimum two columns : ds and y</center></h3>
</div>


```python
# Renaming the column names accroding to Prophet's requirements
prophet_df=data_df[['Timestamp','Weighted_Price']]
prophet_df.rename(columns={'Timestamp':'ds','Weighted_Price':'y'},inplace=True)

```

    /opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:4446: SettingWithCopyWarning:
    
    
    A value is trying to be set on a copy of a slice from a DataFrame
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
    
    

<div class='alert alert-warning'>
    <h2><center>Creating and fitting the Prophet model with default values</center></h2>
    <h3>We will first explore the default Prophet model. Create the Prophet instance with all default values, fit the dataset.</h3>
</div>


```python
prophet_basic = Prophet()
prophet_basic.fit(prophet_df[['ds','y']])
```




    <fbprophet.forecaster.Prophet at 0x7ff8c52e7c10>



<div class='alert alert-warning'>
    <h2><center>Predicting the values for the future</center></h2>
<h4>For predicting the values using Prophet, we need to create a dataframe with ds(datetime stamp) containing the dates for which we want to make the predictions.<br><br>
We use make_future_dataframe() to which we specify the number of days to extend into the future. By default it includes dates from the history</h4>
</div>


```python
future= prophet_basic.make_future_dataframe(periods=365)#Making predictions for one year
future.tail(2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ds</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3652</th>
      <td>2021-12-30</td>
    </tr>
    <tr>
      <th>3653</th>
      <td>2021-12-31</td>
    </tr>
  </tbody>
</table>
</div>




```python
forecast=prophet_basic.predict(future)
```

<div class='alert alert-warning'>
    <h3><center>Plotting the predicted data</center></h3>
</div>


```python
fig1 =prophet_basic.plot(forecast)
```


    
![png](/assets/images/bitcoin/output_61_0.png)
    


<div class='alert alert-warning'>
    <h3><center>Plotting the Forecasted components(Trend and Seasonality)</center></h3>
</div>


```python
fig1 = prophet_basic.plot_components(forecast)
```


    
![png](/assets/images/bitcoin/output_63_0.png)
    


<div class='alert alert-warning'>
    <h3><center>Adding ChangePoints to Prophet</center></h3>
<h4>Changepoints are the datetime points where the time series have abrupt changes in the trajectory.<br>
By default, Prophet adds 25 changepoints to the initial 80% of the data-set.<br>
    <br><center>Letâ€™s plot the vertical lines where the potential changepoints occurred</center><h4>
    </div>


```python
fig = prophet_basic.plot(forecast)
a = add_changepoints_to_plot(fig.gca(), prophet_basic, forecast)
```


    
![png](/assets/images/bitcoin/output_65_0.png)
    


<div class='alert alert-warning'>
        <h3> Following are the Changepoints, where the time series had abrupt changes in the trajectory.</h3>
</div>


```python
print(f'{m_}Change points:\n {y_}{prophet_basic.changepoints}\n')
```

    [37mChange points:
     [36m105    2012-04-14
    210    2012-07-28
    316    2012-11-11
    421    2013-02-24
    526    2013-06-09
    631    2013-09-22
    736    2014-01-05
    842    2014-04-21
    947    2014-08-04
    1052   2014-11-17
    1157   2015-03-02
    1262   2015-06-15
    1368   2015-09-29
    1473   2016-01-12
    1578   2016-04-26
    1683   2016-08-09
    1788   2016-11-22
    1894   2017-03-08
    1999   2017-06-21
    2104   2017-10-04
    2209   2018-01-17
    2314   2018-05-02
    2420   2018-08-16
    2525   2018-11-29
    2630   2019-03-14
    Name: ds, dtype: datetime64[ns]
    
    

<div class='alert alert-warning'>
    <h2><center>Adding Multiple Regressors</center></h2>
<h3>Additional regressors can be added to the Prophet model. This is done by using add_regressor. Additional regressor column value needs to be present in both the fitting as well as prediction dataframes.<h3>
    <h3><center>Creating fitting and predicting dataset with additional regressors</center></h3>
    </div>


```python
data_df.columns
```




    Index(['Timestamp', 'Open', 'High', 'Low', 'Close', 'Volume_(BTC)',
           'Volume_(Currency)', 'Weighted_Price', 'Volume_market_mean',
           'close_mean', 'volume_curr_mean', 'open/close', 'gap', 'month'],
          dtype='object')




```python
prophet_df['Open'] = data_df['Open']
prophet_df['High'] = data_df['High']
prophet_df['Low'] = data_df['Low']
prophet_df['Vol(BTC)'] = data_df['Volume_(BTC)']
prophet_df['Vol(curr)'] = data_df['Volume_(Currency)']
prophet_df['Volume_market_mean'] = data_df['Volume_market_mean']
prophet_df['close_mean'] = data_df['close_mean']
prophet_df['volume_curr_mean'] = data_df['volume_curr_mean']
prophet_df['open/close'] = data_df['open/close']
prophet_df['gap'] = data_df['gap']

```

    /opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:1: SettingWithCopyWarning:
    
    
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
    
    /opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:2: SettingWithCopyWarning:
    
    
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
    
    /opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:3: SettingWithCopyWarning:
    
    
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
    
    /opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:4: SettingWithCopyWarning:
    
    
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
    
    /opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:5: SettingWithCopyWarning:
    
    
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
    
    /opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:6: SettingWithCopyWarning:
    
    
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
    
    /opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:7: SettingWithCopyWarning:
    
    
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
    
    /opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:8: SettingWithCopyWarning:
    
    
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
    
    /opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:9: SettingWithCopyWarning:
    
    
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
    
    /opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:10: SettingWithCopyWarning:
    
    
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
    
    


```python
pro_regressor= Prophet()
pro_regressor.add_regressor('Open')
pro_regressor.add_regressor('High')
pro_regressor.add_regressor('Low')
pro_regressor.add_regressor('Vol(BTC)')
pro_regressor.add_regressor('Vol(curr)')
pro_regressor.add_regressor('Volume_market_mean')
pro_regressor.add_regressor('close_mean')
pro_regressor.add_regressor('volume_curr_mean')
pro_regressor.add_regressor('open/close')
pro_regressor.add_regressor('gap')

train_X= prophet_df[:2500]
test_X= prophet_df[2500:]


```


```python
#Fitting the data
pro_regressor.fit(train_X)
future_data = pro_regressor.make_future_dataframe(periods=249)
```


```python
#Forecast the data for Test  data
forecast_data = pro_regressor.predict(test_X)
pro_regressor.plot(forecast_data);
```


    
![png](/assets/images/bitcoin/output_73_0.png)
    


<div class='alert alert-warning'>
<h3><center>6 different types of metrics are shown by each time horizon, but by taking moving average over 37 days in this case (can be changed by â€˜rolling_windowâ€™ option).</center></h3>
</div>


```python
df_cv = cross_validation(pro_regressor, initial='100 days', period='180 days', horizon = '365 days')
pm = performance_metrics(df_cv, rolling_window=0.1)
display(pm.head(),pm.tail())
fig = plot_cross_validation_metric(df_cv, metric='mape', rolling_window=0.1)
plt.show()
```


      0%|          | 0/12 [00:00<?, ?it/s]



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>horizon</th>
      <th>mse</th>
      <th>rmse</th>
      <th>mae</th>
      <th>mape</th>
      <th>mdape</th>
      <th>coverage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>37 days</td>
      <td>0.413771</td>
      <td>0.643251</td>
      <td>0.216705</td>
      <td>0.001091</td>
      <td>0.000171</td>
      <td>0.785388</td>
    </tr>
    <tr>
      <th>1</th>
      <td>38 days</td>
      <td>0.469662</td>
      <td>0.685319</td>
      <td>0.231994</td>
      <td>0.001188</td>
      <td>0.000175</td>
      <td>0.779680</td>
    </tr>
    <tr>
      <th>2</th>
      <td>39 days</td>
      <td>0.539967</td>
      <td>0.734825</td>
      <td>0.249433</td>
      <td>0.001294</td>
      <td>0.000178</td>
      <td>0.772831</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40 days</td>
      <td>0.615809</td>
      <td>0.784735</td>
      <td>0.268262</td>
      <td>0.001407</td>
      <td>0.000180</td>
      <td>0.767123</td>
    </tr>
    <tr>
      <th>4</th>
      <td>41 days</td>
      <td>0.688987</td>
      <td>0.830052</td>
      <td>0.286306</td>
      <td>0.001525</td>
      <td>0.000188</td>
      <td>0.764840</td>
    </tr>
  </tbody>
</table>
</div>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>horizon</th>
      <th>mse</th>
      <th>rmse</th>
      <th>mae</th>
      <th>mape</th>
      <th>mdape</th>
      <th>coverage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>324</th>
      <td>361 days</td>
      <td>23.897097</td>
      <td>4.888466</td>
      <td>1.934879</td>
      <td>0.006200</td>
      <td>0.000758</td>
      <td>0.849315</td>
    </tr>
    <tr>
      <th>325</th>
      <td>362 days</td>
      <td>23.913066</td>
      <td>4.890099</td>
      <td>1.935748</td>
      <td>0.006199</td>
      <td>0.000381</td>
      <td>0.851598</td>
    </tr>
    <tr>
      <th>326</th>
      <td>363 days</td>
      <td>23.928062</td>
      <td>4.891632</td>
      <td>1.936313</td>
      <td>0.006196</td>
      <td>0.000713</td>
      <td>0.853881</td>
    </tr>
    <tr>
      <th>327</th>
      <td>364 days</td>
      <td>23.944867</td>
      <td>4.893349</td>
      <td>1.935958</td>
      <td>0.006192</td>
      <td>0.000586</td>
      <td>0.856164</td>
    </tr>
    <tr>
      <th>328</th>
      <td>365 days</td>
      <td>23.963754</td>
      <td>4.895279</td>
      <td>1.936640</td>
      <td>0.006186</td>
      <td>0.000557</td>
      <td>0.858447</td>
    </tr>
  </tbody>
</table>
</div>



    
![png](/assets/images/bitcoin/output_75_3.png)
    


<div class='alert alert-info'>
    <h3><center>MAPE</center></h3>
    <p>The MAPE (Mean Absolute Percent Error) measures the size of the error in percentage terms. It is calculated as the average of the unsigned percentage error</p>
    <p>Many organizations focus primarily on the MAPE when assessing forecast accuracy. Most people are comfortable thinking in percentage terms, making the MAPE easy to interpret. It can also convey information when you donâ€™t know the itemâ€™s demand volume. For example, telling your manager, "we were off by less than 4%" is more meaningful than saying "we were off by 3,000 cases," if your manager doesnâ€™t know an itemâ€™s typical demand volume.<p>
    <img src="https://www.forecastpro.com/Trends/images/MAPE1.jpg" width='500'>
</div>

<div class='alert alert-warning'>
    <h3><center>What Prophet doesnt do</center></h3>
    <h4><b>1.Prophet does not allow non-Gaussian noise distribution:<b></h4> 
<p>In Prophet, noise distribution is always Gaussian and pre-transformation of y values is the only way to handle the values following skewed distribution.</p>
        <h4><b>2. Prophet does not take autocorrelation on residual into account</b></h4>
<p>Since epsilon noise portion in the formula assume i.i.d. normal distribution, the residual is not assumed to have autocorrelation, unlike ARIMA model.</p>
        <h4><b>3. Prophet does not assume stochastic trend</b></h4>
<p>Prophetâ€™s trend component is always deterministic+possible changepoints and it wonâ€™t assume stochastic trend unlike ARIMA.</p>
</div>

<a id="8"></a>
<h2 style='background-color:#87CEFA; border:0; color:black'><center>Prediction using Pycaret</center><h2>




```python
!pip install pycaret
```

    Collecting pycaret
      Downloading pycaret-2.3.0-py3-none-any.whl (261 kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 261 kB 870 kB/s 
    [?25hRequirement already satisfied: Boruta in /opt/conda/lib/python3.7/site-packages (from pycaret) (0.3)
    Collecting mlflow
      Downloading mlflow-1.14.1-py3-none-any.whl (14.2 MB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 14.2 MB 6.4 MB/s 
    [?25hRequirement already satisfied: seaborn in /opt/conda/lib/python3.7/site-packages (from pycaret) (0.11.1)
    Requirement already satisfied: mlxtend in /opt/conda/lib/python3.7/site-packages (from pycaret) (0.18.0)
    Requirement already satisfied: pandas-profiling>=2.8.0 in /opt/conda/lib/python3.7/site-packages (from pycaret) (2.8.0)
    Requirement already satisfied: joblib in /opt/conda/lib/python3.7/site-packages (from pycaret) (1.0.0)
    Requirement already satisfied: umap-learn in /opt/conda/lib/python3.7/site-packages (from pycaret) (0.5.1)
    Requirement already satisfied: lightgbm>=2.3.1 in /opt/conda/lib/python3.7/site-packages (from pycaret) (3.1.1)
    Requirement already satisfied: scikit-plot in /opt/conda/lib/python3.7/site-packages (from pycaret) (0.3.7)
    Requirement already satisfied: plotly>=4.4.1 in /opt/conda/lib/python3.7/site-packages (from pycaret) (4.14.3)
    Requirement already satisfied: IPython in /opt/conda/lib/python3.7/site-packages (from pycaret) (7.19.0)
    Collecting pyod
      Downloading pyod-0.8.7.tar.gz (101 kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 101 kB 5.4 MB/s 
    [?25hRequirement already satisfied: gensim in /opt/conda/lib/python3.7/site-packages (from pycaret) (3.8.3)
    Collecting scikit-learn==0.23.2
      Downloading scikit_learn-0.23.2-cp37-cp37m-manylinux1_x86_64.whl (6.8 MB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6.8 MB 16.8 MB/s 
    [?25hRequirement already satisfied: pandas in /opt/conda/lib/python3.7/site-packages (from pycaret) (1.2.0)
    Requirement already satisfied: cufflinks>=0.17.0 in /opt/conda/lib/python3.7/site-packages (from pycaret) (0.17.3)
    Requirement already satisfied: matplotlib in /opt/conda/lib/python3.7/site-packages (from pycaret) (3.3.3)
    Requirement already satisfied: spacy<2.4.0 in /opt/conda/lib/python3.7/site-packages (from pycaret) (2.3.5)
    Requirement already satisfied: scipy<=1.5.4 in /opt/conda/lib/python3.7/site-packages (from pycaret) (1.5.4)
    Requirement already satisfied: textblob in /opt/conda/lib/python3.7/site-packages (from pycaret) (0.15.3)
    Requirement already satisfied: pyLDAvis in /opt/conda/lib/python3.7/site-packages (from pycaret) (3.2.1)
    Requirement already satisfied: numpy==1.19.5 in /opt/conda/lib/python3.7/site-packages (from pycaret) (1.19.5)
    Requirement already satisfied: kmodes>=0.10.1 in /opt/conda/lib/python3.7/site-packages (from pycaret) (0.11.0)
    Requirement already satisfied: imbalanced-learn>=0.7.0 in /opt/conda/lib/python3.7/site-packages (from pycaret) (0.8.0)
    Requirement already satisfied: nltk in /opt/conda/lib/python3.7/site-packages (from pycaret) (3.2.4)
    Requirement already satisfied: yellowbrick>=1.0.1 in /opt/conda/lib/python3.7/site-packages (from pycaret) (1.3.post1)
    Requirement already satisfied: wordcloud in /opt/conda/lib/python3.7/site-packages (from pycaret) (1.8.1)
    Requirement already satisfied: ipywidgets in /opt/conda/lib/python3.7/site-packages (from pycaret) (7.6.2)
    Requirement already satisfied: threadpoolctl>=2.0.0 in /opt/conda/lib/python3.7/site-packages (from scikit-learn==0.23.2->pycaret) (2.1.0)
    Requirement already satisfied: setuptools>=34.4.1 in /opt/conda/lib/python3.7/site-packages (from cufflinks>=0.17.0->pycaret) (49.6.0.post20201009)
    Requirement already satisfied: colorlover>=0.2.1 in /opt/conda/lib/python3.7/site-packages (from cufflinks>=0.17.0->pycaret) (0.3.0)
    Requirement already satisfied: six>=1.9.0 in /opt/conda/lib/python3.7/site-packages (from cufflinks>=0.17.0->pycaret) (1.15.0)
    Collecting imbalanced-learn>=0.7.0
      Downloading imbalanced_learn-0.7.0-py3-none-any.whl (167 kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 167 kB 25.0 MB/s 
    [?25hRequirement already satisfied: jedi>=0.10 in /opt/conda/lib/python3.7/site-packages (from IPython->pycaret) (0.17.2)
    Requirement already satisfied: pygments in /opt/conda/lib/python3.7/site-packages (from IPython->pycaret) (2.7.3)
    Requirement already satisfied: decorator in /opt/conda/lib/python3.7/site-packages (from IPython->pycaret) (4.4.2)
    Requirement already satisfied: backcall in /opt/conda/lib/python3.7/site-packages (from IPython->pycaret) (0.2.0)
    Requirement already satisfied: pickleshare in /opt/conda/lib/python3.7/site-packages (from IPython->pycaret) (0.7.5)
    Requirement already satisfied: pexpect>4.3 in /opt/conda/lib/python3.7/site-packages (from IPython->pycaret) (4.8.0)
    Requirement already satisfied: prompt-toolkit!=3.0.0,!=3.0.1,<3.1.0,>=2.0.0 in /opt/conda/lib/python3.7/site-packages (from IPython->pycaret) (3.0.8)
    Requirement already satisfied: traitlets>=4.2 in /opt/conda/lib/python3.7/site-packages (from IPython->pycaret) (5.0.5)
    Requirement already satisfied: nbformat>=4.2.0 in /opt/conda/lib/python3.7/site-packages (from ipywidgets->pycaret) (5.0.8)
    Requirement already satisfied: ipykernel>=4.5.1 in /opt/conda/lib/python3.7/site-packages (from ipywidgets->pycaret) (5.1.1)
    Requirement already satisfied: widgetsnbextension~=3.5.0 in /opt/conda/lib/python3.7/site-packages (from ipywidgets->pycaret) (3.5.1)
    Requirement already satisfied: jupyterlab-widgets>=1.0.0 in /opt/conda/lib/python3.7/site-packages (from ipywidgets->pycaret) (1.0.0)
    Requirement already satisfied: jupyter-client in /opt/conda/lib/python3.7/site-packages (from ipykernel>=4.5.1->ipywidgets->pycaret) (6.1.7)
    Requirement already satisfied: tornado>=4.2 in /opt/conda/lib/python3.7/site-packages (from ipykernel>=4.5.1->ipywidgets->pycaret) (5.0.2)
    Requirement already satisfied: parso<0.8.0,>=0.7.0 in /opt/conda/lib/python3.7/site-packages (from jedi>=0.10->IPython->pycaret) (0.7.1)
    Requirement already satisfied: wheel in /opt/conda/lib/python3.7/site-packages (from lightgbm>=2.3.1->pycaret) (0.36.2)
    Requirement already satisfied: jupyter-core in /opt/conda/lib/python3.7/site-packages (from nbformat>=4.2.0->ipywidgets->pycaret) (4.7.0)
    Requirement already satisfied: ipython-genutils in /opt/conda/lib/python3.7/site-packages (from nbformat>=4.2.0->ipywidgets->pycaret) (0.2.0)
    Requirement already satisfied: jsonschema!=2.5.0,>=2.4 in /opt/conda/lib/python3.7/site-packages (from nbformat>=4.2.0->ipywidgets->pycaret) (3.2.0)
    Requirement already satisfied: importlib-metadata in /opt/conda/lib/python3.7/site-packages (from jsonschema!=2.5.0,>=2.4->nbformat>=4.2.0->ipywidgets->pycaret) (3.3.0)
    Requirement already satisfied: attrs>=17.4.0 in /opt/conda/lib/python3.7/site-packages (from jsonschema!=2.5.0,>=2.4->nbformat>=4.2.0->ipywidgets->pycaret) (20.3.0)
    Requirement already satisfied: pyrsistent>=0.14.0 in /opt/conda/lib/python3.7/site-packages (from jsonschema!=2.5.0,>=2.4->nbformat>=4.2.0->ipywidgets->pycaret) (0.17.3)
    Requirement already satisfied: python-dateutil>=2.7.3 in /opt/conda/lib/python3.7/site-packages (from pandas->pycaret) (2.8.1)
    Requirement already satisfied: pytz>=2017.3 in /opt/conda/lib/python3.7/site-packages (from pandas->pycaret) (2020.5)
    Requirement already satisfied: phik>=0.9.10 in /opt/conda/lib/python3.7/site-packages (from pandas-profiling>=2.8.0->pycaret) (0.10.0)
    Requirement already satisfied: confuse>=1.0.0 in /opt/conda/lib/python3.7/site-packages (from pandas-profiling>=2.8.0->pycaret) (1.4.0)
    Requirement already satisfied: htmlmin>=0.1.12 in /opt/conda/lib/python3.7/site-packages (from pandas-profiling>=2.8.0->pycaret) (0.1.12)
    Requirement already satisfied: astropy>=4.0 in /opt/conda/lib/python3.7/site-packages (from pandas-profiling>=2.8.0->pycaret) (4.2)
    Requirement already satisfied: requests>=2.23.0 in /opt/conda/lib/python3.7/site-packages (from pandas-profiling>=2.8.0->pycaret) (2.25.1)
    Requirement already satisfied: tangled-up-in-unicode>=0.0.6 in /opt/conda/lib/python3.7/site-packages (from pandas-profiling>=2.8.0->pycaret) (0.0.6)
    Requirement already satisfied: jinja2>=2.11.1 in /opt/conda/lib/python3.7/site-packages (from pandas-profiling>=2.8.0->pycaret) (2.11.2)
    Requirement already satisfied: tqdm>=4.43.0 in /opt/conda/lib/python3.7/site-packages (from pandas-profiling>=2.8.0->pycaret) (4.55.1)
    Requirement already satisfied: visions[type_image_path]==0.4.4 in /opt/conda/lib/python3.7/site-packages (from pandas-profiling>=2.8.0->pycaret) (0.4.4)
    Requirement already satisfied: missingno>=0.4.2 in /opt/conda/lib/python3.7/site-packages (from pandas-profiling>=2.8.0->pycaret) (0.4.2)
    Requirement already satisfied: networkx>=2.4 in /opt/conda/lib/python3.7/site-packages (from visions[type_image_path]==0.4.4->pandas-profiling>=2.8.0->pycaret) (2.5)
    Requirement already satisfied: imagehash in /opt/conda/lib/python3.7/site-packages (from visions[type_image_path]==0.4.4->pandas-profiling>=2.8.0->pycaret) (4.2.0)
    Requirement already satisfied: Pillow in /opt/conda/lib/python3.7/site-packages (from visions[type_image_path]==0.4.4->pandas-profiling>=2.8.0->pycaret) (7.2.0)
    Requirement already satisfied: pyerfa in /opt/conda/lib/python3.7/site-packages (from astropy>=4.0->pandas-profiling>=2.8.0->pycaret) (1.7.1.1)
    Requirement already satisfied: pyyaml in /opt/conda/lib/python3.7/site-packages (from confuse>=1.0.0->pandas-profiling>=2.8.0->pycaret) (5.3.1)
    Requirement already satisfied: MarkupSafe>=0.23 in /opt/conda/lib/python3.7/site-packages (from jinja2>=2.11.1->pandas-profiling>=2.8.0->pycaret) (1.1.1)
    Requirement already satisfied: cycler>=0.10 in /opt/conda/lib/python3.7/site-packages (from matplotlib->pycaret) (0.10.0)
    Requirement already satisfied: kiwisolver>=1.0.1 in /opt/conda/lib/python3.7/site-packages (from matplotlib->pycaret) (1.3.1)
    Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.3 in /opt/conda/lib/python3.7/site-packages (from matplotlib->pycaret) (2.4.7)
    Requirement already satisfied: ptyprocess>=0.5 in /opt/conda/lib/python3.7/site-packages (from pexpect>4.3->IPython->pycaret) (0.7.0)
    Requirement already satisfied: numba>=0.38.1 in /opt/conda/lib/python3.7/site-packages (from phik>=0.9.10->pandas-profiling>=2.8.0->pycaret) (0.52.0)
    Requirement already satisfied: llvmlite<0.36,>=0.35.0 in /opt/conda/lib/python3.7/site-packages (from numba>=0.38.1->phik>=0.9.10->pandas-profiling>=2.8.0->pycaret) (0.35.0)
    Requirement already satisfied: retrying>=1.3.3 in /opt/conda/lib/python3.7/site-packages (from plotly>=4.4.1->pycaret) (1.3.3)
    Requirement already satisfied: wcwidth in /opt/conda/lib/python3.7/site-packages (from prompt-toolkit!=3.0.0,!=3.0.1,<3.1.0,>=2.0.0->IPython->pycaret) (0.2.5)
    Requirement already satisfied: idna<3,>=2.5 in /opt/conda/lib/python3.7/site-packages (from requests>=2.23.0->pandas-profiling>=2.8.0->pycaret) (2.10)
    Requirement already satisfied: certifi>=2017.4.17 in /opt/conda/lib/python3.7/site-packages (from requests>=2.23.0->pandas-profiling>=2.8.0->pycaret) (2020.12.5)
    Requirement already satisfied: urllib3<1.27,>=1.21.1 in /opt/conda/lib/python3.7/site-packages (from requests>=2.23.0->pandas-profiling>=2.8.0->pycaret) (1.26.2)
    Requirement already satisfied: chardet<5,>=3.0.2 in /opt/conda/lib/python3.7/site-packages (from requests>=2.23.0->pandas-profiling>=2.8.0->pycaret) (3.0.4)
    Requirement already satisfied: preshed<3.1.0,>=3.0.2 in /opt/conda/lib/python3.7/site-packages (from spacy<2.4.0->pycaret) (3.0.5)
    Requirement already satisfied: blis<0.8.0,>=0.4.0 in /opt/conda/lib/python3.7/site-packages (from spacy<2.4.0->pycaret) (0.7.4)
    Requirement already satisfied: thinc<7.5.0,>=7.4.1 in /opt/conda/lib/python3.7/site-packages (from spacy<2.4.0->pycaret) (7.4.5)
    Requirement already satisfied: catalogue<1.1.0,>=0.0.7 in /opt/conda/lib/python3.7/site-packages (from spacy<2.4.0->pycaret) (1.0.0)
    Requirement already satisfied: plac<1.2.0,>=0.9.6 in /opt/conda/lib/python3.7/site-packages (from spacy<2.4.0->pycaret) (1.1.3)
    Requirement already satisfied: srsly<1.1.0,>=1.0.2 in /opt/conda/lib/python3.7/site-packages (from spacy<2.4.0->pycaret) (1.0.5)
    Requirement already satisfied: wasabi<1.1.0,>=0.4.0 in /opt/conda/lib/python3.7/site-packages (from spacy<2.4.0->pycaret) (0.8.2)
    Requirement already satisfied: cymem<2.1.0,>=2.0.2 in /opt/conda/lib/python3.7/site-packages (from spacy<2.4.0->pycaret) (2.0.5)
    Requirement already satisfied: murmurhash<1.1.0,>=0.28.0 in /opt/conda/lib/python3.7/site-packages (from spacy<2.4.0->pycaret) (1.0.5)
    Requirement already satisfied: zipp>=0.5 in /opt/conda/lib/python3.7/site-packages (from importlib-metadata->jsonschema!=2.5.0,>=2.4->nbformat>=4.2.0->ipywidgets->pycaret) (3.4.0)
    Requirement already satisfied: typing-extensions>=3.6.4 in /opt/conda/lib/python3.7/site-packages (from importlib-metadata->jsonschema!=2.5.0,>=2.4->nbformat>=4.2.0->ipywidgets->pycaret) (3.7.4.3)
    Requirement already satisfied: notebook>=4.4.1 in /opt/conda/lib/python3.7/site-packages (from widgetsnbextension~=3.5.0->ipywidgets->pycaret) (5.5.0)
    Requirement already satisfied: pyzmq>=17 in /opt/conda/lib/python3.7/site-packages (from notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (20.0.0)
    Requirement already satisfied: terminado>=0.8.1 in /opt/conda/lib/python3.7/site-packages (from notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (0.9.2)
    Requirement already satisfied: nbconvert in /opt/conda/lib/python3.7/site-packages (from notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (6.0.7)
    Requirement already satisfied: Send2Trash in /opt/conda/lib/python3.7/site-packages (from notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (1.5.0)
    Requirement already satisfied: smart-open>=1.8.1 in /opt/conda/lib/python3.7/site-packages (from gensim->pycaret) (3.0.0)
    Requirement already satisfied: PyWavelets in /opt/conda/lib/python3.7/site-packages (from imagehash->visions[type_image_path]==0.4.4->pandas-profiling>=2.8.0->pycaret) (1.1.1)
    Requirement already satisfied: gitpython>=2.1.0 in /opt/conda/lib/python3.7/site-packages (from mlflow->pycaret) (3.1.12)
    Requirement already satisfied: sqlalchemy in /opt/conda/lib/python3.7/site-packages (from mlflow->pycaret) (1.3.22)
    Requirement already satisfied: entrypoints in /opt/conda/lib/python3.7/site-packages (from mlflow->pycaret) (0.3)
    Collecting querystring-parser
      Downloading querystring_parser-1.2.4-py2.py3-none-any.whl (7.9 kB)
    Requirement already satisfied: protobuf>=3.6.0 in /opt/conda/lib/python3.7/site-packages (from mlflow->pycaret) (3.14.0)
    Collecting databricks-cli>=0.8.7
      Downloading databricks-cli-0.14.2.tar.gz (54 kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 54 kB 1.7 MB/s 
    [?25hCollecting prometheus-flask-exporter
      Downloading prometheus_flask_exporter-0.18.1.tar.gz (21 kB)
    Requirement already satisfied: click>=7.0 in /opt/conda/lib/python3.7/site-packages (from mlflow->pycaret) (7.1.2)
    Collecting alembic<=1.4.1
      Downloading alembic-1.4.1.tar.gz (1.1 MB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1.1 MB 25.8 MB/s 
    [?25hRequirement already satisfied: Flask in /opt/conda/lib/python3.7/site-packages (from mlflow->pycaret) (1.1.2)
    Collecting gunicorn
      Downloading gunicorn-20.0.4-py2.py3-none-any.whl (77 kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 77 kB 4.6 MB/s 
    [?25hRequirement already satisfied: cloudpickle in /opt/conda/lib/python3.7/site-packages (from mlflow->pycaret) (1.6.0)
    Requirement already satisfied: docker>=4.0.0 in /opt/conda/lib/python3.7/site-packages (from mlflow->pycaret) (4.4.1)
    Requirement already satisfied: sqlparse>=0.3.1 in /opt/conda/lib/python3.7/site-packages (from mlflow->pycaret) (0.4.1)
    Requirement already satisfied: Mako in /opt/conda/lib/python3.7/site-packages (from alembic<=1.4.1->mlflow->pycaret) (1.1.4)
    Requirement already satisfied: python-editor>=0.3 in /opt/conda/lib/python3.7/site-packages (from alembic<=1.4.1->mlflow->pycaret) (1.0.4)
    Requirement already satisfied: tabulate>=0.7.7 in /opt/conda/lib/python3.7/site-packages (from databricks-cli>=0.8.7->mlflow->pycaret) (0.8.8)
    Requirement already satisfied: websocket-client>=0.32.0 in /opt/conda/lib/python3.7/site-packages (from docker>=4.0.0->mlflow->pycaret) (0.57.0)
    Requirement already satisfied: gitdb<5,>=4.0.1 in /opt/conda/lib/python3.7/site-packages (from gitpython>=2.1.0->mlflow->pycaret) (4.0.5)
    Requirement already satisfied: smmap<4,>=3.0.1 in /opt/conda/lib/python3.7/site-packages (from gitdb<5,>=4.0.1->gitpython>=2.1.0->mlflow->pycaret) (3.0.4)
    Requirement already satisfied: Werkzeug>=0.15 in /opt/conda/lib/python3.7/site-packages (from Flask->mlflow->pycaret) (1.0.1)
    Requirement already satisfied: itsdangerous>=0.24 in /opt/conda/lib/python3.7/site-packages (from Flask->mlflow->pycaret) (1.1.0)
    Requirement already satisfied: testpath in /opt/conda/lib/python3.7/site-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (0.4.4)
    Requirement already satisfied: defusedxml in /opt/conda/lib/python3.7/site-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (0.6.0)
    Requirement already satisfied: mistune<2,>=0.8.1 in /opt/conda/lib/python3.7/site-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (0.8.4)
    Requirement already satisfied: jupyterlab-pygments in /opt/conda/lib/python3.7/site-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (0.1.2)
    Requirement already satisfied: nbclient<0.6.0,>=0.5.0 in /opt/conda/lib/python3.7/site-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (0.5.1)
    Requirement already satisfied: bleach in /opt/conda/lib/python3.7/site-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (3.2.1)
    Requirement already satisfied: pandocfilters>=1.4.1 in /opt/conda/lib/python3.7/site-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (1.4.2)
    Requirement already satisfied: nest-asyncio in /opt/conda/lib/python3.7/site-packages (from nbclient<0.6.0,>=0.5.0->nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (1.4.3)
    Requirement already satisfied: async-generator in /opt/conda/lib/python3.7/site-packages (from nbclient<0.6.0,>=0.5.0->nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (1.10)
    Requirement already satisfied: packaging in /opt/conda/lib/python3.7/site-packages (from bleach->nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (20.8)
    Requirement already satisfied: webencodings in /opt/conda/lib/python3.7/site-packages (from bleach->nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (0.5.1)
    Requirement already satisfied: prometheus_client in /opt/conda/lib/python3.7/site-packages (from prometheus-flask-exporter->mlflow->pycaret) (0.9.0)
    Requirement already satisfied: numexpr in /opt/conda/lib/python3.7/site-packages (from pyLDAvis->pycaret) (2.7.2)
    Requirement already satisfied: future in /opt/conda/lib/python3.7/site-packages (from pyLDAvis->pycaret) (0.18.2)
    Requirement already satisfied: funcy in /opt/conda/lib/python3.7/site-packages (from pyLDAvis->pycaret) (1.15)
    Requirement already satisfied: statsmodels in /opt/conda/lib/python3.7/site-packages (from pyod->pycaret) (0.12.1)
    Requirement already satisfied: patsy>=0.5 in /opt/conda/lib/python3.7/site-packages (from statsmodels->pyod->pycaret) (0.5.1)
    Requirement already satisfied: pynndescent>=0.5 in /opt/conda/lib/python3.7/site-packages (from umap-learn->pycaret) (0.5.2)
    Building wheels for collected packages: alembic, databricks-cli, prometheus-flask-exporter, pyod
      Building wheel for alembic (setup.py) ... [?25l- \ | done
    [?25h  Created wheel for alembic: filename=alembic-1.4.1-py2.py3-none-any.whl size=158155 sha256=e35fcbb75a55d5dff15ff2a2040ad3e630619b1e043a92c4e2ef8b7bfd40cbd5
      Stored in directory: /root/.cache/pip/wheels/be/5d/0a/9e13f53f4f5dfb67cd8d245bb7cdffe12f135846f491a283e3
      Building wheel for databricks-cli (setup.py) ... [?25l- \ | done
    [?25h  Created wheel for databricks-cli: filename=databricks_cli-0.14.2-py3-none-any.whl size=100732 sha256=83edd649440f3d65bd686eb176a40eff921b9814631982a3057effbcc8ef681c
      Stored in directory: /root/.cache/pip/wheels/54/8a/cd/8861fff0bea4a752ffe7561eb74e130c9ae38cdb7e43eb7b66
      Building wheel for prometheus-flask-exporter (setup.py) ... [?25l- \ done
    [?25h  Created wheel for prometheus-flask-exporter: filename=prometheus_flask_exporter-0.18.1-py3-none-any.whl size=17158 sha256=9551355c39ea18a7623c90c636856ca0125d39feb6eb6a51d14e218f4e009fec
      Stored in directory: /root/.cache/pip/wheels/c4/b6/b5/e76659f3b2a3a226565e27f0a7eb7a3ac93c3f4d68acfbe617
      Building wheel for pyod (setup.py) ... [?25l- \ done
    [?25h  Created wheel for pyod: filename=pyod-0.8.7-py3-none-any.whl size=115977 sha256=98c49db9e4e5832478048f293e87703fa1a297998a2cff2583c236049c89b54a
      Stored in directory: /root/.cache/pip/wheels/b2/ef/b6/3375e239feb7768b5fc35846a0cc22e04312b7c813de07c4dc
    Successfully built alembic databricks-cli prometheus-flask-exporter pyod
    Installing collected packages: scikit-learn, querystring-parser, prometheus-flask-exporter, gunicorn, databricks-cli, alembic, pyod, mlflow, imbalanced-learn, pycaret
      Attempting uninstall: scikit-learn
        Found existing installation: scikit-learn 0.24.1
        Uninstalling scikit-learn-0.24.1:
          Successfully uninstalled scikit-learn-0.24.1
      Attempting uninstall: alembic
        Found existing installation: alembic 1.5.4
        Uninstalling alembic-1.5.4:
          Successfully uninstalled alembic-1.5.4
      Attempting uninstall: imbalanced-learn
        Found existing installation: imbalanced-learn 0.8.0
        Uninstalling imbalanced-learn-0.8.0:
          Successfully uninstalled imbalanced-learn-0.8.0
    Successfully installed alembic-1.4.1 databricks-cli-0.14.2 gunicorn-20.0.4 imbalanced-learn-0.7.0 mlflow-1.14.1 prometheus-flask-exporter-0.18.1 pycaret-2.3.0 pyod-0.8.7 querystring-parser-1.2.4 scikit-learn-0.23.2


<img src='https://i1.wp.com/pycaret.org/wp-content/uploads/2020/04/thumbnail.png?fit=1166%2C656&ssl=1' width='500'>

<div class='alert alert-warning'>
    <h3><center> PyCaretâ€™s Regression Module</center></h3><br>
    <h4>PyCaretâ€™s Regression Module is a supervised machine learning module that is used for estimating the relationships between a dependent variable (often called the â€˜outcome variableâ€™, or â€˜targetâ€™) and one or more independent variables (often called â€˜featuresâ€™, â€˜predictorsâ€™, or â€˜covariatesâ€™).<br><br> The objective of regression is to predict continuous values such as predicting sales amount, predicting quantity, predicting temperature, etc. This module provides several pre-processing features that prepare the data for modeling through the setup function. It has over 25 ready-to-use algorithms and several plots to analyze the performance of trained models.</h4>
</div>


```python
data_df.columns
```




    Index(['Timestamp', 'Open', 'High', 'Low', 'Close', 'Volume_(BTC)',
           'Volume_(Currency)', 'Weighted_Price', 'Volume_market_mean',
           'close_mean', 'volume_curr_mean', 'open/close', 'gap', 'month'],
          dtype='object')




```python
data_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Timestamp</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume_(BTC)</th>
      <th>Volume_(Currency)</th>
      <th>Weighted_Price</th>
      <th>Volume_market_mean</th>
      <th>close_mean</th>
      <th>volume_curr_mean</th>
      <th>open/close</th>
      <th>gap</th>
      <th>month</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-12-31</td>
      <td>4.465000</td>
      <td>4.482500</td>
      <td>4.465000</td>
      <td>4.482500</td>
      <td>23.829470</td>
      <td>106.330086</td>
      <td>4.471603</td>
      <td>23.829470</td>
      <td>4.482500</td>
      <td>106.330086</td>
      <td>0.996096</td>
      <td>0.017500</td>
      <td>12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2012-01-01</td>
      <td>4.806667</td>
      <td>4.806667</td>
      <td>4.806667</td>
      <td>4.806667</td>
      <td>7.200667</td>
      <td>35.259720</td>
      <td>4.806667</td>
      <td>7.200667</td>
      <td>4.806667</td>
      <td>35.259720</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2012-01-02</td>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>19.048000</td>
      <td>95.239998</td>
      <td>5.000000</td>
      <td>19.048000</td>
      <td>5.000000</td>
      <td>95.239998</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2012-01-03</td>
      <td>5.252500</td>
      <td>5.252500</td>
      <td>5.252500</td>
      <td>5.252500</td>
      <td>11.004660</td>
      <td>58.100651</td>
      <td>5.252500</td>
      <td>11.004660</td>
      <td>5.252500</td>
      <td>58.100651</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2012-01-04</td>
      <td>5.200000</td>
      <td>5.223333</td>
      <td>5.200000</td>
      <td>5.223333</td>
      <td>11.914806</td>
      <td>63.119579</td>
      <td>5.208159</td>
      <td>11.914806</td>
      <td>5.223333</td>
      <td>63.119579</td>
      <td>0.995533</td>
      <td>0.023333</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




```python
%%time
from pycaret.regression import *
data_df.set_index('Timestamp',inplace=True)
exp_name = setup(data=data_df,target="Weighted_Price",silent=True)
best_model = compare_models()
```


<style  type="text/css" >
    #T_cf2d2_ th {
          text-align: left;
    }#T_cf2d2_row0_col0,#T_cf2d2_row0_col5,#T_cf2d2_row0_col6,#T_cf2d2_row1_col0,#T_cf2d2_row1_col1,#T_cf2d2_row1_col2,#T_cf2d2_row1_col3,#T_cf2d2_row1_col4,#T_cf2d2_row1_col5,#T_cf2d2_row1_col6,#T_cf2d2_row2_col0,#T_cf2d2_row2_col1,#T_cf2d2_row2_col2,#T_cf2d2_row2_col3,#T_cf2d2_row2_col4,#T_cf2d2_row3_col0,#T_cf2d2_row3_col1,#T_cf2d2_row3_col2,#T_cf2d2_row3_col3,#T_cf2d2_row3_col4,#T_cf2d2_row3_col5,#T_cf2d2_row3_col6,#T_cf2d2_row4_col0,#T_cf2d2_row4_col1,#T_cf2d2_row4_col2,#T_cf2d2_row4_col3,#T_cf2d2_row4_col4,#T_cf2d2_row4_col5,#T_cf2d2_row4_col6,#T_cf2d2_row5_col0,#T_cf2d2_row5_col1,#T_cf2d2_row5_col2,#T_cf2d2_row5_col3,#T_cf2d2_row5_col4,#T_cf2d2_row5_col5,#T_cf2d2_row5_col6,#T_cf2d2_row6_col0,#T_cf2d2_row6_col1,#T_cf2d2_row6_col2,#T_cf2d2_row6_col3,#T_cf2d2_row6_col4,#T_cf2d2_row6_col5,#T_cf2d2_row6_col6,#T_cf2d2_row7_col0,#T_cf2d2_row7_col1,#T_cf2d2_row7_col2,#T_cf2d2_row7_col3,#T_cf2d2_row7_col4,#T_cf2d2_row7_col5,#T_cf2d2_row7_col6,#T_cf2d2_row8_col0,#T_cf2d2_row8_col1,#T_cf2d2_row8_col2,#T_cf2d2_row8_col3,#T_cf2d2_row8_col4,#T_cf2d2_row8_col5,#T_cf2d2_row8_col6,#T_cf2d2_row9_col0,#T_cf2d2_row9_col1,#T_cf2d2_row9_col2,#T_cf2d2_row9_col3,#T_cf2d2_row9_col4,#T_cf2d2_row9_col5,#T_cf2d2_row9_col6,#T_cf2d2_row10_col0,#T_cf2d2_row10_col1,#T_cf2d2_row10_col2,#T_cf2d2_row10_col3,#T_cf2d2_row10_col4,#T_cf2d2_row10_col5,#T_cf2d2_row10_col6,#T_cf2d2_row11_col0,#T_cf2d2_row11_col1,#T_cf2d2_row11_col2,#T_cf2d2_row11_col3,#T_cf2d2_row11_col4,#T_cf2d2_row11_col5,#T_cf2d2_row11_col6,#T_cf2d2_row12_col0,#T_cf2d2_row12_col1,#T_cf2d2_row12_col2,#T_cf2d2_row12_col3,#T_cf2d2_row12_col4,#T_cf2d2_row12_col5,#T_cf2d2_row12_col6,#T_cf2d2_row13_col0,#T_cf2d2_row13_col1,#T_cf2d2_row13_col2,#T_cf2d2_row13_col3,#T_cf2d2_row13_col4,#T_cf2d2_row13_col5,#T_cf2d2_row13_col6,#T_cf2d2_row14_col0,#T_cf2d2_row14_col1,#T_cf2d2_row14_col2,#T_cf2d2_row14_col3,#T_cf2d2_row14_col4,#T_cf2d2_row14_col5,#T_cf2d2_row14_col6,#T_cf2d2_row15_col0,#T_cf2d2_row15_col1,#T_cf2d2_row15_col2,#T_cf2d2_row15_col3,#T_cf2d2_row15_col4,#T_cf2d2_row15_col5,#T_cf2d2_row15_col6,#T_cf2d2_row16_col0,#T_cf2d2_row16_col1,#T_cf2d2_row16_col2,#T_cf2d2_row16_col3,#T_cf2d2_row16_col4,#T_cf2d2_row16_col5,#T_cf2d2_row16_col6,#T_cf2d2_row17_col0,#T_cf2d2_row17_col1,#T_cf2d2_row17_col2,#T_cf2d2_row17_col3,#T_cf2d2_row17_col4,#T_cf2d2_row17_col5,#T_cf2d2_row17_col6,#T_cf2d2_row18_col0,#T_cf2d2_row18_col1,#T_cf2d2_row18_col2,#T_cf2d2_row18_col3,#T_cf2d2_row18_col4,#T_cf2d2_row18_col5,#T_cf2d2_row18_col6{
            text-align:  left;
            text-align:  left;
        }#T_cf2d2_row0_col1,#T_cf2d2_row0_col2,#T_cf2d2_row0_col3,#T_cf2d2_row0_col4,#T_cf2d2_row2_col5,#T_cf2d2_row2_col6{
            text-align:  left;
            text-align:  left;
            background-color:  yellow;
        }#T_cf2d2_row0_col7,#T_cf2d2_row1_col7,#T_cf2d2_row2_col7,#T_cf2d2_row3_col7,#T_cf2d2_row4_col7,#T_cf2d2_row5_col7,#T_cf2d2_row6_col7,#T_cf2d2_row7_col7,#T_cf2d2_row8_col7,#T_cf2d2_row9_col7,#T_cf2d2_row10_col7,#T_cf2d2_row11_col7,#T_cf2d2_row12_col7,#T_cf2d2_row13_col7,#T_cf2d2_row14_col7,#T_cf2d2_row15_col7,#T_cf2d2_row17_col7,#T_cf2d2_row18_col7{
            text-align:  left;
            text-align:  left;
            background-color:  lightgrey;
        }#T_cf2d2_row16_col7{
            text-align:  left;
            text-align:  left;
            background-color:  yellow;
            background-color:  lightgrey;
        }</style><table id="T_cf2d2_" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >Model</th>        <th class="col_heading level0 col1" >MAE</th>        <th class="col_heading level0 col2" >MSE</th>        <th class="col_heading level0 col3" >RMSE</th>        <th class="col_heading level0 col4" >R2</th>        <th class="col_heading level0 col5" >RMSLE</th>        <th class="col_heading level0 col6" >MAPE</th>        <th class="col_heading level0 col7" >TT (Sec)</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_cf2d2_level0_row0" class="row_heading level0 row0" >catboost</th>
                        <td id="T_cf2d2_row0_col0" class="data row0 col0" >CatBoost Regressor</td>
                        <td id="T_cf2d2_row0_col1" class="data row0 col1" >183.6878</td>
                        <td id="T_cf2d2_row0_col2" class="data row0 col2" >178220.4162</td>
                        <td id="T_cf2d2_row0_col3" class="data row0 col3" >419.0222</td>
                        <td id="T_cf2d2_row0_col4" class="data row0 col4" >0.9914</td>
                        <td id="T_cf2d2_row0_col5" class="data row0 col5" >0.4478</td>
                        <td id="T_cf2d2_row0_col6" class="data row0 col6" >0.4928</td>
                        <td id="T_cf2d2_row0_col7" class="data row0 col7" >1.9100</td>
            </tr>
            <tr>
                        <th id="T_cf2d2_level0_row1" class="row_heading level0 row1" >lightgbm</th>
                        <td id="T_cf2d2_row1_col0" class="data row1 col0" >Light Gradient Boosting Machine</td>
                        <td id="T_cf2d2_row1_col1" class="data row1 col1" >231.6918</td>
                        <td id="T_cf2d2_row1_col2" class="data row1 col2" >327250.6935</td>
                        <td id="T_cf2d2_row1_col3" class="data row1 col3" >563.3952</td>
                        <td id="T_cf2d2_row1_col4" class="data row1 col4" >0.9842</td>
                        <td id="T_cf2d2_row1_col5" class="data row1 col5" >0.4428</td>
                        <td id="T_cf2d2_row1_col6" class="data row1 col6" >0.5006</td>
                        <td id="T_cf2d2_row1_col7" class="data row1 col7" >0.0600</td>
            </tr>
            <tr>
                        <th id="T_cf2d2_level0_row2" class="row_heading level0 row2" >et</th>
                        <td id="T_cf2d2_row2_col0" class="data row2 col0" >Extra Trees Regressor</td>
                        <td id="T_cf2d2_row2_col1" class="data row2 col1" >239.3661</td>
                        <td id="T_cf2d2_row2_col2" class="data row2 col2" >374008.2720</td>
                        <td id="T_cf2d2_row2_col3" class="data row2 col3" >608.3075</td>
                        <td id="T_cf2d2_row2_col4" class="data row2 col4" >0.9819</td>
                        <td id="T_cf2d2_row2_col5" class="data row2 col5" >0.1513</td>
                        <td id="T_cf2d2_row2_col6" class="data row2 col6" >0.0964</td>
                        <td id="T_cf2d2_row2_col7" class="data row2 col7" >0.4280</td>
            </tr>
            <tr>
                        <th id="T_cf2d2_level0_row3" class="row_heading level0 row3" >xgboost</th>
                        <td id="T_cf2d2_row3_col0" class="data row3 col0" >Extreme Gradient Boosting</td>
                        <td id="T_cf2d2_row3_col1" class="data row3 col1" >262.8371</td>
                        <td id="T_cf2d2_row3_col2" class="data row3 col2" >373224.8719</td>
                        <td id="T_cf2d2_row3_col3" class="data row3 col3" >607.0643</td>
                        <td id="T_cf2d2_row3_col4" class="data row3 col4" >0.9818</td>
                        <td id="T_cf2d2_row3_col5" class="data row3 col5" >0.2688</td>
                        <td id="T_cf2d2_row3_col6" class="data row3 col6" >0.2039</td>
                        <td id="T_cf2d2_row3_col7" class="data row3 col7" >21.9100</td>
            </tr>
            <tr>
                        <th id="T_cf2d2_level0_row4" class="row_heading level0 row4" >rf</th>
                        <td id="T_cf2d2_row4_col0" class="data row4 col0" >Random Forest Regressor</td>
                        <td id="T_cf2d2_row4_col1" class="data row4 col1" >263.7926</td>
                        <td id="T_cf2d2_row4_col2" class="data row4 col2" >489991.7419</td>
                        <td id="T_cf2d2_row4_col3" class="data row4 col3" >690.7930</td>
                        <td id="T_cf2d2_row4_col4" class="data row4 col4" >0.9762</td>
                        <td id="T_cf2d2_row4_col5" class="data row4 col5" >0.1956</td>
                        <td id="T_cf2d2_row4_col6" class="data row4 col6" >0.1565</td>
                        <td id="T_cf2d2_row4_col7" class="data row4 col7" >0.5690</td>
            </tr>
            <tr>
                        <th id="T_cf2d2_level0_row5" class="row_heading level0 row5" >gbr</th>
                        <td id="T_cf2d2_row5_col0" class="data row5 col0" >Gradient Boosting Regressor</td>
                        <td id="T_cf2d2_row5_col1" class="data row5 col1" >403.2292</td>
                        <td id="T_cf2d2_row5_col2" class="data row5 col2" >565324.3538</td>
                        <td id="T_cf2d2_row5_col3" class="data row5 col3" >749.4895</td>
                        <td id="T_cf2d2_row5_col4" class="data row5 col4" >0.9724</td>
                        <td id="T_cf2d2_row5_col5" class="data row5 col5" >0.6833</td>
                        <td id="T_cf2d2_row5_col6" class="data row5 col6" >1.1719</td>
                        <td id="T_cf2d2_row5_col7" class="data row5 col7" >0.1640</td>
            </tr>
            <tr>
                        <th id="T_cf2d2_level0_row6" class="row_heading level0 row6" >dt</th>
                        <td id="T_cf2d2_row6_col0" class="data row6 col0" >Decision Tree Regressor</td>
                        <td id="T_cf2d2_row6_col1" class="data row6 col1" >369.6441</td>
                        <td id="T_cf2d2_row6_col2" class="data row6 col2" >1003012.0933</td>
                        <td id="T_cf2d2_row6_col3" class="data row6 col3" >974.3942</td>
                        <td id="T_cf2d2_row6_col4" class="data row6 col4" >0.9517</td>
                        <td id="T_cf2d2_row6_col5" class="data row6 col5" >0.2025</td>
                        <td id="T_cf2d2_row6_col6" class="data row6 col6" >0.1226</td>
                        <td id="T_cf2d2_row6_col7" class="data row6 col7" >0.0170</td>
            </tr>
            <tr>
                        <th id="T_cf2d2_level0_row7" class="row_heading level0 row7" >ada</th>
                        <td id="T_cf2d2_row7_col0" class="data row7 col0" >AdaBoost Regressor</td>
                        <td id="T_cf2d2_row7_col1" class="data row7 col1" >1130.3140</td>
                        <td id="T_cf2d2_row7_col2" class="data row7 col2" >2108658.2672</td>
                        <td id="T_cf2d2_row7_col3" class="data row7 col3" >1450.1221</td>
                        <td id="T_cf2d2_row7_col4" class="data row7 col4" >0.8978</td>
                        <td id="T_cf2d2_row7_col5" class="data row7 col5" >1.9121</td>
                        <td id="T_cf2d2_row7_col6" class="data row7 col6" >18.0874</td>
                        <td id="T_cf2d2_row7_col7" class="data row7 col7" >0.1020</td>
            </tr>
            <tr>
                        <th id="T_cf2d2_level0_row8" class="row_heading level0 row8" >lasso</th>
                        <td id="T_cf2d2_row8_col0" class="data row8 col0" >Lasso Regression</td>
                        <td id="T_cf2d2_row8_col1" class="data row8 col1" >1793.6839</td>
                        <td id="T_cf2d2_row8_col2" class="data row8 col2" >5900649.7500</td>
                        <td id="T_cf2d2_row8_col3" class="data row8 col3" >2419.6586</td>
                        <td id="T_cf2d2_row8_col4" class="data row8 col4" >0.7139</td>
                        <td id="T_cf2d2_row8_col5" class="data row8 col5" >1.9914</td>
                        <td id="T_cf2d2_row8_col6" class="data row8 col6" >23.0321</td>
                        <td id="T_cf2d2_row8_col7" class="data row8 col7" >0.0170</td>
            </tr>
            <tr>
                        <th id="T_cf2d2_level0_row9" class="row_heading level0 row9" >br</th>
                        <td id="T_cf2d2_row9_col0" class="data row9 col0" >Bayesian Ridge</td>
                        <td id="T_cf2d2_row9_col1" class="data row9 col1" >1791.5918</td>
                        <td id="T_cf2d2_row9_col2" class="data row9 col2" >5901871.4888</td>
                        <td id="T_cf2d2_row9_col3" class="data row9 col3" >2419.9138</td>
                        <td id="T_cf2d2_row9_col4" class="data row9 col4" >0.7138</td>
                        <td id="T_cf2d2_row9_col5" class="data row9 col5" >1.9913</td>
                        <td id="T_cf2d2_row9_col6" class="data row9 col6" >22.9639</td>
                        <td id="T_cf2d2_row9_col7" class="data row9 col7" >0.0140</td>
            </tr>
            <tr>
                        <th id="T_cf2d2_level0_row10" class="row_heading level0 row10" >lr</th>
                        <td id="T_cf2d2_row10_col0" class="data row10 col0" >Linear Regression</td>
                        <td id="T_cf2d2_row10_col1" class="data row10 col1" >1794.3332</td>
                        <td id="T_cf2d2_row10_col2" class="data row10 col2" >5901736.7000</td>
                        <td id="T_cf2d2_row10_col3" class="data row10 col3" >2419.8575</td>
                        <td id="T_cf2d2_row10_col4" class="data row10 col4" >0.7138</td>
                        <td id="T_cf2d2_row10_col5" class="data row10 col5" >1.9902</td>
                        <td id="T_cf2d2_row10_col6" class="data row10 col6" >23.0464</td>
                        <td id="T_cf2d2_row10_col7" class="data row10 col7" >0.3630</td>
            </tr>
            <tr>
                        <th id="T_cf2d2_level0_row11" class="row_heading level0 row11" >ridge</th>
                        <td id="T_cf2d2_row11_col0" class="data row11 col0" >Ridge Regression</td>
                        <td id="T_cf2d2_row11_col1" class="data row11 col1" >1794.1785</td>
                        <td id="T_cf2d2_row11_col2" class="data row11 col2" >5901515.3000</td>
                        <td id="T_cf2d2_row11_col3" class="data row11 col3" >2419.8126</td>
                        <td id="T_cf2d2_row11_col4" class="data row11 col4" >0.7138</td>
                        <td id="T_cf2d2_row11_col5" class="data row11 col5" >1.9902</td>
                        <td id="T_cf2d2_row11_col6" class="data row11 col6" >23.0417</td>
                        <td id="T_cf2d2_row11_col7" class="data row11 col7" >0.0150</td>
            </tr>
            <tr>
                        <th id="T_cf2d2_level0_row12" class="row_heading level0 row12" >lar</th>
                        <td id="T_cf2d2_row12_col0" class="data row12 col0" >Least Angle Regression</td>
                        <td id="T_cf2d2_row12_col1" class="data row12 col1" >1795.0417</td>
                        <td id="T_cf2d2_row12_col2" class="data row12 col2" >5906285.2613</td>
                        <td id="T_cf2d2_row12_col3" class="data row12 col3" >2420.7440</td>
                        <td id="T_cf2d2_row12_col4" class="data row12 col4" >0.7136</td>
                        <td id="T_cf2d2_row12_col5" class="data row12 col5" >1.9905</td>
                        <td id="T_cf2d2_row12_col6" class="data row12 col6" >23.1717</td>
                        <td id="T_cf2d2_row12_col7" class="data row12 col7" >0.0160</td>
            </tr>
            <tr>
                        <th id="T_cf2d2_level0_row13" class="row_heading level0 row13" >llar</th>
                        <td id="T_cf2d2_row13_col0" class="data row13 col0" >Lasso Least Angle Regression</td>
                        <td id="T_cf2d2_row13_col1" class="data row13 col1" >1796.6443</td>
                        <td id="T_cf2d2_row13_col2" class="data row13 col2" >5915254.5579</td>
                        <td id="T_cf2d2_row13_col3" class="data row13 col3" >2423.5220</td>
                        <td id="T_cf2d2_row13_col4" class="data row13 col4" >0.7133</td>
                        <td id="T_cf2d2_row13_col5" class="data row13 col5" >1.9838</td>
                        <td id="T_cf2d2_row13_col6" class="data row13 col6" >22.6064</td>
                        <td id="T_cf2d2_row13_col7" class="data row13 col7" >0.0150</td>
            </tr>
            <tr>
                        <th id="T_cf2d2_level0_row14" class="row_heading level0 row14" >knn</th>
                        <td id="T_cf2d2_row14_col0" class="data row14 col0" >K Neighbors Regressor</td>
                        <td id="T_cf2d2_row14_col1" class="data row14 col1" >1357.0336</td>
                        <td id="T_cf2d2_row14_col2" class="data row14 col2" >5932810.6500</td>
                        <td id="T_cf2d2_row14_col3" class="data row14 col3" >2431.1251</td>
                        <td id="T_cf2d2_row14_col4" class="data row14 col4" >0.7122</td>
                        <td id="T_cf2d2_row14_col5" class="data row14 col5" >0.6789</td>
                        <td id="T_cf2d2_row14_col6" class="data row14 col6" >0.7534</td>
                        <td id="T_cf2d2_row14_col7" class="data row14 col7" >0.0400</td>
            </tr>
            <tr>
                        <th id="T_cf2d2_level0_row15" class="row_heading level0 row15" >en</th>
                        <td id="T_cf2d2_row15_col0" class="data row15 col0" >Elastic Net</td>
                        <td id="T_cf2d2_row15_col1" class="data row15 col1" >1802.8902</td>
                        <td id="T_cf2d2_row15_col2" class="data row15 col2" >6076827.8500</td>
                        <td id="T_cf2d2_row15_col3" class="data row15 col3" >2456.3670</td>
                        <td id="T_cf2d2_row15_col4" class="data row15 col4" >0.7053</td>
                        <td id="T_cf2d2_row15_col5" class="data row15 col5" >1.9876</td>
                        <td id="T_cf2d2_row15_col6" class="data row15 col6" >23.4865</td>
                        <td id="T_cf2d2_row15_col7" class="data row15 col7" >0.0150</td>
            </tr>
            <tr>
                        <th id="T_cf2d2_level0_row16" class="row_heading level0 row16" >omp</th>
                        <td id="T_cf2d2_row16_col0" class="data row16 col0" >Orthogonal Matching Pursuit</td>
                        <td id="T_cf2d2_row16_col1" class="data row16 col1" >2093.9200</td>
                        <td id="T_cf2d2_row16_col2" class="data row16 col2" >7904132.3910</td>
                        <td id="T_cf2d2_row16_col3" class="data row16 col3" >2800.8495</td>
                        <td id="T_cf2d2_row16_col4" class="data row16 col4" >0.6173</td>
                        <td id="T_cf2d2_row16_col5" class="data row16 col5" >2.2043</td>
                        <td id="T_cf2d2_row16_col6" class="data row16 col6" >28.6742</td>
                        <td id="T_cf2d2_row16_col7" class="data row16 col7" >0.0130</td>
            </tr>
            <tr>
                        <th id="T_cf2d2_level0_row17" class="row_heading level0 row17" >huber</th>
                        <td id="T_cf2d2_row17_col0" class="data row17 col0" >Huber Regressor</td>
                        <td id="T_cf2d2_row17_col1" class="data row17 col1" >1525.6962</td>
                        <td id="T_cf2d2_row17_col2" class="data row17 col2" >9137486.0548</td>
                        <td id="T_cf2d2_row17_col3" class="data row17 col3" >2974.8224</td>
                        <td id="T_cf2d2_row17_col4" class="data row17 col4" >0.5539</td>
                        <td id="T_cf2d2_row17_col5" class="data row17 col5" >1.3690</td>
                        <td id="T_cf2d2_row17_col6" class="data row17 col6" >7.0921</td>
                        <td id="T_cf2d2_row17_col7" class="data row17 col7" >0.0290</td>
            </tr>
            <tr>
                        <th id="T_cf2d2_level0_row18" class="row_heading level0 row18" >par</th>
                        <td id="T_cf2d2_row18_col0" class="data row18 col0" >Passive Aggressive Regressor</td>
                        <td id="T_cf2d2_row18_col1" class="data row18 col1" >5225.3425</td>
                        <td id="T_cf2d2_row18_col2" class="data row18 col2" >125653157.1112</td>
                        <td id="T_cf2d2_row18_col3" class="data row18 col3" >9884.3408</td>
                        <td id="T_cf2d2_row18_col4" class="data row18 col4" >-4.8612</td>
                        <td id="T_cf2d2_row18_col5" class="data row18 col5" >1.1314</td>
                        <td id="T_cf2d2_row18_col6" class="data row18 col6" >2.0195</td>
                        <td id="T_cf2d2_row18_col7" class="data row18 col7" >0.0200</td>
            </tr>
    </tbody></table>


    CPU times: user 15.4 s, sys: 1.56 s, total: 16.9 s
    Wall time: 4min 28s
    

<div class="alert alert-info">
    
<h2><center> CatBoost Regressor give a R-square value of 0.9912</center></h2>
<p> Using pycaret we could find that Catboost, LightGBM, and Extra trees regressor have a good R-square value</p>
<p> But interms of MAPE value, Extra trees Regressor has a better value compared to Catboost but with a low R-square value</p>
    
</div>
    

<a id="9"></a>
## References 

1. [Time series prediction using Prophet in Python by Renu Khandelwal](https://towardsdatascience.com/time-series-prediction-using-prophet-in-python-35d65f626236)
2. [Facebook Prophet by Moto DEI](https://medium.com/swlh/facebook-prophet-426421f7e331)
3. [Housing pices EDA and Prediction by Ruchi Bhatia](https://www.kaggle.com/ruchi798/housing-prices-eda-and-prediction)
4. [88.9 r2_score with pycaret by Kerem Yucedag](https://www.kaggle.com/keremyceda/88-9-r2-score-with-pycaret)
5. [Pycaret documentation](https://pycaret.org/regression/)


```python

```
